name: Deploy to Local

on:
  push:
    branches:
      - main 

jobs:
  deploy:
    runs-on: self-hosted

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2
        with:
          node-version: 16

      - name: Check if folder exists
        run: |
          if (Test-Path -Path "C:\laragon\www\pet-food-store" -PathType Container) { Remove-Item -Path "C:\laragon\www\pet-food-store" -Recurse -Force }

      - name: Deploy to Local
        run: xcopy /E /I pet-food-store C:\laragon\www\

      - name: Deploy SQL files
        run: |
          Get-Content C:\laragon\www\pet-food-store\11.sql | mysql -h localhost -u root
